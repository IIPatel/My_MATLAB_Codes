clc
clear all
close all


t = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
A = [2.5 4 12 7 6 4 3 3.5 2 1.5 0.65 0.5 0.45 0.9 0.5 0
     2 3 11 34.5 0 0 5 4 3 2.5 2 1 0.75 0.5 0.25 0    
     4 5 5 4.5 4.9 5 6 6.5 8 9 15.1 2 5.2 1.3 1 1.2
     2.25 3.5 10.5 15 16 7.5 5 3 2.5 2.25 1.75 1 0.5 0.25 0.25 0 
     2 3.5 11 0 17.5 5 4.5 3 2 2 1.95 1 0.95 0.85 0.75 0.65
     t
     t]
%A = A./1000

k = 1500;
a = 0.65;

m = 1.68;
L = 0.732;
Jo = m*L^2/3;

w_n = sqrt(k*a^2/Jo);
f_n = w_n/2/pi

c = [5 5 5 15 15 15 15]';
b = [0.6 0.4 0.2 0.6 0.6 0.4 0.2]';
zeta = c.*b.^2./(2*Jo*w_n)

w_r = (w_n./(2.*zeta)).*sqrt(sqrt(1+8.*zeta.^2)-1); 
f_r = w_r/2/pi

f = [2 4 6 6.5 7 7.5 8 8.5 9 9.5 10 12 14 16 18 20];
w = f.*2*pi

i = 1;
while i <= 7
    if i == 3
        f(13) = 11;
        w(13) = f(13)*2*pi;
        X(i,:) = A(i,:)./sqrt((1-(w./w_n).^2).^2+(2.*w./w_n.*zeta(i)).^2);
        f(13) = 14;
        w(13) = f(13)*2*pi;
        phi(i,:) = atand((2.*zeta(i).*w./w_n)./(1-(w./w_n).^2));
    elseif i == 2
        w(5) = 0;
        w(6) = 0;
        X(i,:) = A(i,:)./sqrt((1-(w./w_n).^2).^2+(2.*w./w_n.*zeta(i)).^2);
        f(5) = 7;
        w(5) = f(5)*2*pi;
        f(6) = 7.5;
        w(6) = f(6)*2*pi;
        phi(i,:) = atand((2.*zeta(i).*w./w_n)./(1-(w./w_n).^2));
    elseif i == 4
        w(4) = 0;
        X(i,:) = A(i,:)./sqrt((1-(w./w_n).^2).^2+(2.*w./w_n.*zeta(i)).^2);
        f(4) = 6.5;
        w(4) = f(4)*2*pi;
        phi(i,:) = atand((2.*zeta(i).*w./w_n)./(1-(w./w_n).^2));
    else
            X(i,:) = A(i,:)./sqrt((1-(w./w_n).^2).^2+(2.*w./w_n.*zeta(i)).^2);
            phi(i,:) = atand((2.*zeta(i).*w./w_n)./(1-(w./w_n).^2));
    end
    i = i+1;
end

i = 6;
while i <= 16
    phi(:,i) = phi(:,i)+180;
    i = i+1;
end
%phi = phi.*180/2/pi

ws = 2*pi.*[2 4 6 6.5 7 7.5 8 8.5 9 9.5 10 11 12 16 18 20];
X(3,:) = [4.32319722561840,7.13291688544596,15.2760282548467,21.3609711127413,57.4862670251353,93.4173239449204,30.4696213796387,18.5243164771928,15.5536607666651,13.0966927173646,17.3681060365914,4.12076821835986,1.18217865555245,0.343438992296539,0.197773829365600,0.185275087497364]
% phi(3,:) = [0.245578819181282,0.648307344873486,2.08306058214467,3.50758064059669,9.37171035327774,163.868065632132,175.379476871467,177.246852844045,178.011677434040,178.429233390204,178.693144120263,179.009615852716,179.194133305200,179.519773810991,179.595555011470,179.649181074221]
figure (1)
plot(w, X(1,:),w, X(2,:),ws, X(3,:),w, X(4,:),w, X(5,:),w, X(6,:),w, X(7,:))
xlabel('Driving Frequency (\omega) [rad/s)]')
ylabel('X')
title('X vs. \omega')
grid on
grid minor
legend('Case 1', 'Case 2', 'Case 3', 'Case 4' ,'Case 4', 'Case 5(NA)', 'Case 6(NA)')

figure (2)
plot(w, phi)
xlabel('Driving Frequency (\omega) [rad/s]')
ylabel('Phase (\phi) [^o]')
title('\phi vs. \omega')
grid on
grid minor
legend('Case 1', 'Case 2', 'Case 3', 'Case 4' ,'Case 5', 'Case 6')
